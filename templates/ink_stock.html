{% extends "base.html" %}
{% block content %}
<h4>ðŸ–¨ Ink Stock Management</h4>

<div class="row">
<div class="col-md-6">
<select id="ink_in" class="form-select mb-2"></select>
<input id="qty_in" type="number" class="form-control mb-2">
<button class="btn btn-success w-100" onclick="addStock()">ADD</button>
</div>

<div class="col-md-6">
<select id="ink_sell" class="form-select mb-2"></select>
<input id="qty_sell" type="number" class="form-control mb-2">
<button class="btn btn-danger w-100" onclick="sellStock()">SELL</button>
</div>
</div>

<table class="table mt-3">
<tbody id="tbl"></tbody>
</table>

<script>
async function api(u,o={}){return(await fetch(u,o)).json()}
async function load(){
 let d=await api('/api/ink'),o='',t=''
 d.forEach(r=>{
  o+=`<option value="${r.id}">${r.name}</option>`
  let c=r.qty<5?'ðŸ”´':r.qty<=10?'ðŸŸ¡':'ðŸŸ¢'
  t+=`<tr><td>${r.name}</td><td>${r.qty}</td><td>${c}</td></tr>`
 })
 ink_in.innerHTML=o; ink_sell.innerHTML=o; tbl.innerHTML=t
}
async function addStock(){
 await api('/api/ink/in',{method:'POST',headers:{'Content-Type':'application/json'},
 body:JSON.stringify({id:ink_in.value,qty:qty_in.value})});load()
}
async function sellStock(){
 await api('/api/ink/sell',{method:'POST',headers:{'Content-Type':'application/json'},
 body:JSON.stringify({id:ink_sell.value,qty:qty_sell.value})});load()
}
load()
</script>
{% endblock %}