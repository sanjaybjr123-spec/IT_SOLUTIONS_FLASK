{% extends "base.html" %}
{% block content %}

<div class="card p-3">
  <h5>Overdue Device List (&gt; 10 Days)</h5>

  <div class="table-responsive">
    <table class="table table-sm" id="tbl">
      <thead class="table-warning">
        <tr>
          <th>#</th>
          <th>Customer</th>
          <th>Phone</th>
          <th>Model</th>
          <th>Receive Date</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
async function loadOverdue(){
  try{
    const r = await fetch("/api/overdue");
    const data = await r.json();

    const tb = document.querySelector("#tbl tbody");
    tb.innerHTML = "";

    data.forEach((r,i)=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${i+1}</td>
        <td>${r.customer}</td>
        <td>${r.phone}</td>
        <td>${r.model}</td>
        <td>${r.receive_date}</td>
        <td><span class="badge bg-danger">${r.status}</span></td>
      `;
      tb.appendChild(tr);
    });
  }catch(e){
    alert("Failed to load overdue list");
  }
}
loadOverdue();
</script>

{% endblock %}